<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>SafeBrowser</title>
</head>
<body>

<script>
document.body.style.margin = "0";
document.body.style.fontFamily = "Arial, sans-serif";
document.body.style.background = "#f5f5f5";

const container = document.createElement("div");
container.style.padding = "20px";

const title = document.createElement("h1");
title.textContent = "SafeBrowser";
container.appendChild(title);

const input = document.createElement("input");
input.type = "text";
input.placeholder = "Search the web safely...";
input.style.width = "70%";
input.style.padding = "10px";
input.style.fontSize = "16px";

const button = document.createElement("button");
button.textContent = "Search";
button.style.padding = "10px";
button.style.marginLeft = "10px";
button.style.cursor = "pointer";

const results = document.createElement("div");
results.style.marginTop = "20px";

container.appendChild(input);
container.appendChild(button);
container.appendChild(results);
document.body.appendChild(container);

// ðŸ”‘ PUT YOUR KEYS HERE
const API_KEY = "AIzaSyCAS2w0p4l5jknR9W475sXlV0NNYpLir4o";
const CX_ID = "607b6c88dbeeb4f38";

// Read ?q= from URL
function getQueryFromURL() {
    const params = new URLSearchParams(window.location.search);
    return params.get("q");
}

// Update URL without reload
function updateURL(query) {
    const params = new URLSearchParams(window.location.search);
    params.set("q", query);
    history.pushState(null, "", "?" + params.toString());
}

button.onclick = () => search();
input.addEventListener("keydown", e => {
    if (e.key === "Enter") search();
});

function search() {
    const query = input.value.trim();
    if (!query) return;

    updateURL(query);
    results.textContent = "Loading...";

    fetch(`https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(query)}&key=${API_KEY}&cx=${CX_ID}`)
        .then(res => res.json())
        .then(data => {
            results.innerHTML = "";

            if (!data.items) {
                results.textContent = "No results found.";
                return;
            }

            data.items.forEach(item => {
                const card = document.createElement("div");
                card.style.background = "white";
                card.style.padding = "15px";
                card.style.marginBottom = "10px";
                card.style.borderRadius = "6px";

                const link = document.createElement("a");
                link.href = item.link;
                link.textContent = item.title;
                link.target = "_blank";
                link.style.fontSize = "18px";
                link.style.color = "#1a0dab";
                link.style.textDecoration = "none";

                const snippet = document.createElement("p");
                snippet.textContent = item.snippet;
                snippet.style.color = "#333";

                card.appendChild(link);
                card.appendChild(snippet);
                results.appendChild(card);
            });
        })
        .catch(err => {
            results.textContent = "Error fetching results.";
            console.error(err);
        });
}

// Auto-search on load if ?q= exists
const initialQuery = getQueryFromURL();
if (initialQuery) {
    input.value = initialQuery;
    search();
}
</script>

</body>
</html>
